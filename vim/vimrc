

" We want to use Vim and not traditional Vi
set nocompatible

" Syntax highlighting
syntax on

" Tab policies
set tabstop=2
set shiftwidth=2
set expandtab

" AutoIndent
set autoindent

" Search
set incsearch
set hlsearch

" No spurious swap files
set noswapfile

"
" -------------
" Vundle entries
"
"
filetype off
set rtp+=~/.vim/bundle/Vundle.vim

call vundle#begin()

" Manage Vundle with Vundle
Plugin 'gmarik/Vundle.vim'

" Bufexplorer
Plugin 'jlanzarotta/bufexplorer'

" FuzzyFinder
Plugin 'L9'
Plugin 'FuzzyFinder'

" YouCompleteMe
Plugin 'Valloric/YouCompleteMe'

" Omnisharp
Plugin 'nosami/Omnisharp'

" Using for automatic Omnisharp server start
Plugin 'tpope/vim-dispatch'

" Using for Omnisharp code issues and syntax errors
Plugin 'scrooloose/syntastic'

call vundle#end()

" -------------
"

"
" Python utility for C++ editor syncing
"
function! CppSync()
python << EOF
import vim
import os
# This regex will fail if there's more than one . in the path

def get_file_name():
  cur_file_path = vim.current.buffer.name
  basename = os.path.basename(cur_file_path)
  filename, extension = os.path.splitext(basename)
  return [ cur_file_path, filename, extension ]

def open_file_in_split(filepath):
  if len(vim.windows) <= 1:
    vim.command('vsplit')

  vim.command('wincmd l')
  vim.command('e '+filepath)
  vim.command('set filetype=cpp')
  vim.command('wincmd h')
  vim.command('set filetype=cpp')

path, name, extension = get_file_name()
header_basename = path.replace(extension,'.h')
open_file_in_split(header_basename)

EOF
endfunction

" Run CppSync() when any file is loaded
autocmd BufNewFile,BufRead *.cpp call CppSync()

"
" Run main.py in current working directory
"
function! RunMainPy()
  !python3 ./main.py
endfunction

"
" Load Custom Keybindings
"
let mapleader = "-"

nnoremap <leader>v :vsplit<cr>
nnoremap <leader>s :split<cr>
nnoremap <leader>q :quit<cr>

nnoremap <leader>fb :FufBuffer<cr>
nnoremap <leader>ff :FufFile<cr>

nnoremap <leader>sv :source ~/.vimrc<cr>
nnoremap <leader>ev :edit ~/.vimrc<cr>

nnoremap <leader>pi :PluginInstall<cr>
nnoremap <leader>ps :PluginSearch
nnoremap <leader>pc :PluginClean<cr>

nnoremap <leader>pp :call RunMainPy()<cr>

map <C-B> :BufExplorer<CR>

" File type detection
filetype plugin indent on

